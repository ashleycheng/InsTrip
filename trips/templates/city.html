{% load static %}
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale-1" />
    <title>InsTrip</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="{% static 'css/city.css' %}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>

    
</head>

<body>
    <!-- navigation -->
    <nav id="navMin" class="navbar navbar-dark bg-dark shadow navbar-expand-md sticky-top ps-2 pe-2">
        <div class="container-fluid">
            <a href="#" class="navbar-brand text-info fas fa-fish"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
              <ul class="navbar-nav ml-auto">
                <li class="nav-item"><a href="/instrip/" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="#" class="nav-link">API doc</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Admin</a></li>
              </ul>
            </div>
            <!-- <div class="navbar-text mx-lg-3">
                <a href="#" class="btn btn-info text-white shadow">Sign up</a>
            </div> -->
        </div>
    </nav>

    <!-- city -->
    <section id="city">
        <div class="container my-5 ">
            <div class="city-img row ">
                <div class="col-6 mx-auto">
                  <img class="mx-auto d-block img-fluid" src="{{ city_image }}"/>
                </div>
                <div class="col-6 mx-auto">
                  <h2 class="display-5 my-3"><strong>{{ city_name_ch }}</strong></h2>
                  <p class="text-muted mb-5">
                    {{ city_description_1 }}
                    <span class="collapse" id="more">
                      {{ city_description_2 }}
                    </span> 
                    <span>
                      ....
                      <a class="link-secondary" href="#more" data-bs-toggle="collapse">看更多<i class="fa fa-caret-down"></i></a>
                    </span>
                    <style>
                      .collapse.in { display: inline !important; }
                    </style>
                  </p>
                </div>

            </div>
        </div>

    </section>


    <section id="program" class="bg-light">
        <div class="container my-5">
            <div class="col-11 mx-auto">
                <h2>人氣景點</h2>
                <p class="text-muted">選擇類型</p>
            </div>  
            <div class="col-11 mx-auto card">
            <div class="card-header">
                <!-- <h5 class="card-title">卡片標題放這裡</h5> -->
                <!--   頁籤   -->
                <ul class="nav nav-pills card-header-tabs" data-bs-tabs="tabs">
                {% for item in result %}
                  {% if  forloop.first %}
                    <li class="nav-item">
                        <!--         <a class="nav-link active" aria-current="true" data-bs-toggle="tab" href="#tab1">Tab-1</a> -->
                        <button class="btn btn-default nav-link active" id="1-tab" data-bs-toggle="tab" data-bs-target="#{{ item.tag }}" type="button"
                                role="tab" aria-controls="{{ item.tag }}" aria-selected="true">{{ item.tag }}</button>
                    </li>
                  {% else %}
                    <li class="nav-item">
                        <button class="nav-link btn btn-default " id="2-tab" data-bs-toggle="tab" data-bs-target="#{{ item.tag }}" type="button" 
                                role="tab" aria-controls="{{ item.tag }}" aria-selected="false">{{ item.tag }}</button>
                    </li>
                  {% endif %}
                {% endfor %}
                </ul>
            </div>
            <!--  內容  -->
            <div class="card-body tab-content">
              {% for item in result %}
                {% if  forloop.first %}
                  <div class="tab-pane active" id="{{ item.tag }}" role="tabpanel" aria-labelledby="home-tab">
                {% else %}
                  <div class="tab-pane" id="{{ item.tag }}">
                {% endif %}
                  {% for loc in item.location %}
                  <div class="col-12 mt-2">
                    <h5>{{ forloop.counter }}. {{ loc.location_name }}</h5>
                    <p class="text-muted"><i class="fa-solid fa-location-dot"></i> {{ loc.address }}
                      <a class="btn btn-secondary btn-sm example-popover-{{ item.tag }}-{{forloop.counter }}" role="button" tabindex="0"  title="Google map">地圖</a>
                    </p> 
       
                    <div hidden>
                        <div id="mypopover-content-{{ item.tag }}-{{forloop.counter }}" class="mapouter w-100"><div class="gmap_canvas"><iframe class="gmap_iframe" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="https://maps.google.com/maps?width=600&amp;height=400&amp;hl=zh-TW&amp;q={{ loc.location_name }}&amp;t=&amp;z=14&amp;ie=UTF8&amp;iwloc=B&amp;output=embed"></iframe><a href="https://embed-googlemap.com"></a></div><style>.mapouter{position:relative;text-align:right;width:600px;height:400px;}.gmap_canvas {overflow:hidden;background:none!important;}.gmap_iframe {width:600px!important;height:400px!important;}</style></div>
                    </div>
                    
                    <script>
                    var popover = new bootstrap.Popover(document.querySelector('.example-popover-{{ item.tag }}-{{forloop.counter }}'), {
                      html: true,
                      content: document.getElementById('mypopover-content-{{ item.tag }}-{{forloop.counter }}'),
                      
                    })
                    </script>
                  </div>
                  <!-- carousel 卡片 -->
                  <div id="slider" class="carousel slide" data-bs-interval="false">
                    <div class="carousel-indicators">
                      <button type="button" data-bs-target="#slider" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                      <button type="button" data-bs-target="#slider" data-bs-slide-to="1" aria-label="Slide 2"></button>
                      <button type="button" data-bs-target="#slider" data-bs-slide-to="2" aria-label="Slide 3"></button>
                    </div>
                    <div class="carousel-inner">
                      <div class="carousel-item active">
                        <!-- card  -->
                        <div class="cards-wrapper row g-4 px-4">
                          {% for shortcode in loc.post %}
                          <div class="card col-md-6 col-lg-3">
                            <div class="card-body">
                              <iframe width="230px" height="360px"  src="https://www.instagram.com/p/{{ shortcode }}/embed" frameborder="0" scrolling="no" ></iframe>
                            </div>
                          </div>
                          {% endfor %}
                        </div>
                        <!-- card end -->
                      </div>

                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#slider" data-bs-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#slider" data-bs-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Next</span>
                    </button>
                  </div>
                  {% endfor %}

                </div>
                {% endfor %}
            </div>
            </div>
        </div>
    </section>
</body>